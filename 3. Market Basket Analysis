basket = df.groupby(['ID Transaksi', 'Nama Produk'])['Jumlah']
basket.head()

# Sum, unstack, Null=0, row index baris using transaction ID
basket = basket.sum().unstack().reset_index().fillna(0).set_index('ID Transaksi')
basket

# one-hot encoding
def encode_units(x):
    if x <= 0:
        return 0
    if x >= 1:
        return 1

basket_encode = basket.applymap(encode_units) # one-hot encoding
basket = basket_encode
basket

frequent_itemsets = apriori(basket, min_support=0.25, use_colnames=True)
frequent_itemsets.sort_values(by='support', ascending=False, na_position='last', inplace = True)
frequent_itemsets

rules = association_rules(frequent_itemsets, metric="lift", min_threshold=1)
rules.sort_values(by='support', ascending=False, na_position='last', inplace = True)
rules

rules.sort_values(by='support', ascending=True, na_position='last', inplace = True)
rules
